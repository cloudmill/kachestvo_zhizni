var animate_open_close, popup, mail_right, base_time_animation = 300;
$(document).ready(function () {
  custom(), additional_functions(300), forms(), sliders()
});
var custom = function () {
  var e = function () {
    $(".help").click(function (e) {
      e.preventDefault(), $(this).find(".help_text").toggleClass("open"), $(this).find(".help_text").offset().left < 30 && ($(this).find(".help_text").addClass("right_mode"), $(window).width() - ($(this).find(".help_text").offset().left + $(this).find(".help_text").width()) < 30 && $(this).find(".help_text").removeClass("right_mode").addClass("center_mode")), $(this).find(".help_text").hasClass("open") || $(this).find(".help_text").removeClass("center_mode").removeClass("right_mode")
    }), $(document).on("click", function (e) {
      !$(".help_text:hover").length > 0 && !$(".help:hover").length > 0 && $(this).find(".help_text").removeClass("open").removeClass("center_mode").removeClass("right_mode")
    })
  },
    t = function () {
      $("[data-target]").click(function (e) {
        e.preventDefault();
        var t = $(this).data("target");
        $("#" + t).hasClass("open") ? ($(".burger__menu").show(), "burger" == t && ($("[data-target=" + t + "]").toggleClass("active"), animate_open_close($("#" + t), !0, function () {
          $("#burger,#burger__tags,#sitebar,.popup__wrapper").hasClass("active") || $("body").removeClass("overflow"), $("#burger__tags").hasClass("active") || $(".header").removeClass("white_pole")
        })), $("#burger,#burger__tags,#sitebar,.popup__wrapper").hasClass("active") || $("body").removeClass("overflow"), "burger__tags" == t && ($("body").addClass("overflow"), $(".header").removeClass("white_pole")), "header__tags" == t && ($(this).toggleClass("active"), animate_open_close($("#" + t)))) : ($(this).toggleClass("active"), animate_open_close($("#" + t)), "burger" == t && $("body").addClass("overflow"), "burger__tags" == t && ($("body").addClass("overflow"), $(".header").addClass("white_pole"), $(".burger__menu").hide(), $(".burger__wrapper").scrollTop(0)), "sitebar" == t && ($(".wrapper").addClass("sitebar_show"), $("body").addClass("overflow")))
      }), $("[data-close]").click(function (e) {
        e.preventDefault();
        var t = $(this).data("close");
        if ("burger" == t) return !1;
        $(".burger__menu").show(), $("#" + t).hasClass("open") && ($("[data-target=" + t + "]").toggleClass("active"), animate_open_close($("#" + t), !0, function () {
          $("#burger,#burger__tags,#sitebar,.popup__wrapper").hasClass("active") || $("body").removeClass("overflow"), $("#burger__tags").hasClass("active") || $(".header").removeClass("white_pole")
        }), "sitebar" == t && $(".wrapper").removeClass("sitebar_show"))
      }), $(document).on("click", function (e) {
        !$("[data-target]:hover").length > 0 && !$("[data-has_target]:hover").length > 0 && (animate_open_close($("[data-has_target]"), !0), $(".burger__menu").show(), $(".wrapper").removeClass("sitebar_show"), $("[data-target]").removeClass("active"), $(".header").removeClass("white_pole"), !$(".popup__item:hover").length > 0 && !$(".popup__item:hover").length > 0 && !$(".js-popup:hover").length > 0 && $("body").removeClass("overflow"))
      })
    },
    o = function () {
      $(window).load("images/logo.svg", function (e) {
        var t = $("header .container").width(),
          o = $("#header__bottom__menu");
        hide_more_items = function () {
          for (t = $("header .container").width(), i = 0; i < o.length; i++) {
            var e, a = 36,
              s = 0;
            o.eq(i).find("li").each(function () {
              a <= t ? a += parseFloat(this.offsetWidth + 1) + parseFloat(window.getComputedStyle(this).marginRight.replace("px", "")) : (this.setAttribute("data-hide", "y"), a - parseFloat(window.getComputedStyle(e).marginRight.replace("px", "")) <= t || e.setAttribute("data-hide", "y"), s++), e = this
            }), o.eq(i).find("[data-hide]").hide(), s > 0 && o.eq(i).append('<li class="header__bottom__menu__more"><a class="header__bottom__menu__more__link" href="#" >...</a></li>')
          }
        };
        var a = function () {
          hide_more_items(), $("#header__bottom__menu").css("opacity", 1), $("#header__bottom__menu").css("max-height", "none")
        };
        a(), $(window).resize(a), $(document).on("click", ".header__bottom__menu__more", function () {
          var e = $(this).parent().find("li[data-hide]");
          for (j = 0; j < e.length; j++) e.eq(j).delay(base_time_animation / 6 * j).fadeIn(base_time_animation);
          $(this).parent().find(".header__bottom__menu__more").remove()
        }), $(document).on("click", function (e) {
          !$("#header__bottom__menu:hover").length > 0 && (hide_more_items(), $(".wrapper_main").css("margin-top", "0px"))
        }), $(document).on("scroll", function (e) {
          !$("#header__bottom__menu:hover").length > 0 && (hide_more_items(), $(".wrapper_main").css("margin-top", "0px"))
        })
      })
    },
    a = function () {
      var e = $("#header__bottom__menu"),
        t = 0,
        o = function () {
          var o = function () {
            for (clearInterval(first_init), $("#header__bottom__menu").find("#monitor_load_complete").remove(), i = 0; i < e.length; i++) {
              e.eq(i).find("li").each(function () {
                t += parseFloat(this.offsetWidth + 1) + parseFloat(window.getComputedStyle(this).marginRight.replace("px", ""))
              })
            }
            $(".header__bottom__menu").css("width", t)
          };
          $("#header__bottom__menu").append('<li id="monitor_load_complete" class="header__bottom__menu__item health"> <a class="header__bottom__menu__item__link" href="#"> Физическое здоровье</a> </li>'), first_init = setInterval(function () {
            158 == parseInt($("#header__bottom__menu").find("#monitor_load_complete").width()) && o()
          }, 1)
        };
      o();
      var a = function () {
        var e = void 0,
          t = $(".header__bottom").scrollLeft();
        $(document).on("mousemove", function (o) {
          s && (null == e && (e = o.pageX), step = e - o.pageX + t, $(".header__bottom").scrollLeft(step))
        })
      },
        s = !1,
        n = !0,
        r = function () {
          $(document).on("mousedown", ".header__bottom__menu", function () {
            s = !0, n = !0, setTimeout(function () {
              n = !1
            }, 300), a()
          }), $(document).on("click", ".header__bottom__menu a", function (e) {
            n || e.preventDefault()
          }), $(document).on("mouseup", function () {
            s = !1
          })
        };
      r()
    },
    s = function () {
      $("#burger__search button").click(function (e) {
        $("#burger__search").hasClass("active") || (e.preventDefault(), $(".burger__search__input").focus(), $("#burger__search").toggleClass("active"))
      }), $(document).on("click", function (e) {
        !$("#burger__search:hover").length > 0 && $("#burger__search").removeClass("active")
      })
    },
    n = {
      form_answer: "<form class='comments__form answer'><textarea type='text'class='inpt__basic comments_form_input'placeholder='Написать ответ'></textarea><button class='btn__basic comments_form_button'>Ответить</button><input type='hidden' name='comment_id' value='value_replace'/></form>",
      textArea: $(".comments_form_input"),
      list_wrapper: $(".comments__list__wrapper"),
      list: $(".comments__list"),
      _answer: function () {
        var e = this;
        $(document).on("click", ".comments__item__top__right__answer", function (t) {
          t.preventDefault(), e.list.find(".comments__form.answer").remove();
          var o = $(this).closest(".comments__item__wrapper"),
            a = e.form_answer.replace("value_replace", 0);
          o.append(a)
        })
      },
      _firstFocusTextArea: function () {
        this.textArea.focus(function () {
          $(this).parent().parent().find(".inpt__wrapper + .comments_form_button").addClass("active")
        })
      },
      _showMore: function () {
        var e = this;
        $(document).on("click", ".comments__show-all", function (t) {
          t.preventDefault(), e.list_wrapper.addClass("active"), $(this).hide()
        })
      },
      init: function () {
        this._firstFocusTextArea(), this._showMore(), this._answer()
      }
    },
    r = {
      header: $("header"),
      oldScroll: 0,
      deltaScroll: 8,
      _headerMove: function (e) {
        this.deltaScroll < Math.abs(e - this.oldScroll) && (this.oldScroll < e ? e > this.header.height() && this.header.addClass("hide") : e > this.header.height() && (this.header.removeClass("hide"), this.header.addClass("fixed"), $(".wrapper_main").addClass("header__fixed")), 0 == e && (this.header.removeClass("fixed"), $(".wrapper_main").removeClass("header__fixed")), this.oldScroll = e)
      },
      _search_but: function () {
        $(".header__search button").click(function (e) {
          !$(".header__search .header__search__input:focus").length > 0 && !$(".header__search .header__search__input:hover").length > 0 && (e.preventDefault(), $(".header__search .header__search__input").focus())
        })
      },
      _headerMove_init: function () {
        this._headerMove($(document).scrollTop());
        var e = this;
        $(document).on("scroll", function () {
          e._headerMove($(document).scrollTop())
        })
      },
      init: function () {
        this._headerMove_init(), this._search_but()
      }
    };
  popup = {
    wrapper: $(".popup__wrapper"),
    popups: $(".popup__item"),
    triggers: {
      open: $(".js-popup"),
      close: $(".js-close")
    },
    successWindow: $("#success"),
    success: function () {
      var e = 2,
        t = this;
      this.wrapper.hasClass("active") || (e = 1), setTimeout(function () {
        1 == e ? (animate_open_close(t.wrapper), animate_open_close($("#success"))) : animate_open_close($(".popup__item.active"), !0, function () {
          animate_open_close(t.successWindow)
        })
      }, 300)
    },
    init: function () {
      var e = this;
      this.triggers.open.click(function (t) {
        t.preventDefault(), animate_open_close(e.wrapper), $("body").addClass("overflow"), animate_open_close($("#" + $(this).attr("data-popup")))
      }), this.triggers.close.click(function (t) {
        t.preventDefault(), $("body").removeClass("overflow"), animate_open_close(e.wrapper, !0), animate_open_close($(this).parent(), !0)
      }), $(document).on("click", function (t) {
        !$(".popup__item:hover").length > 0 && !$(".js-popup:hover").length > 0 && (animate_open_close(e.wrapper, !0), animate_open_close(e.popups, !0))
      })
    }
  };
  var _ = function () {
    var e = $(".article__social"),
      t = $(".article__body").offset().top;
    $(document).on("scroll", function () {
      $(window).width() >= 950 && (t < $(document).scrollTop() + 50 + ($(".header").hasClass("hide") ? 0 : $(".header").height()) && t + $(".article__body").height() > $(document).scrollTop() + 50 + ($(".header").hasClass("hide") ? 0 : $(".header").height()) + e.height() ? (e.css("position", "fixed"), e.css("top", "50px"), e.css("left", $(".article__body").offset().left - 90), e.css("margin-top", $(".header").hasClass("hide") ? 0 : $(".header").height())) : t + $(".article__body").height() <= $(document).scrollTop() + 50 + ($(".header").hasClass("hide") ? 0 : $(".header").height()) + e.height() ? (e.attr("style", ""), e.css("top", "calc(100% - " + e.height() + "px)")) : e.attr("style", ""))
    })
  },
    l = function () {
      var e = !1,
        t = document.getElementById("copy_target"),
        o = document.createRange(),
        a = function () {
          if (t = document.getElementById("copy_target"), document.selection && document.selection.empty) document.selection.empty();
          else if (window.getSelection) {
            var e = window.getSelection();
            e.removeAllRanges()
          }
          o.selectNode(t), window.getSelection().addRange(o);
          try {
            return document.execCommand("copy"), $(document).find("#copy_target").remove(), !0
          } catch (e) {
            return !1
          }
        };
      $(".article__social__item.copy").click(function (t) {
        t.preventDefault(), e || ($(this).append('<div  style="left: -1000%;position: fixed" id="copy_target">' + document.location + "</div>"), a() && ($(this).append('<div class="info_copied"><img src="images/check_f.svg" /> <span>Ссылка скопирована</span></div>'), setTimeout(function () {
          $(document).find(".info_copied").fadeOut(300), setTimeout(function () {
            $(document).find(".info_copied").remove(), e = !1
          })
        }, 3e3), e = !0))
      })
    };
  l(), $(".article__social").length > 0 && _(), t(), e(), s(), $(window).width() > 950 ? o() : a(), n.init(), r.init(), popup.init()
},
  forms = function () {
    var e = function () {
      $(document).on("submit", "form", function (e) {
        e.preventDefault();
        var o = $(this).find('[name="mail"]');
        t([o], $(this)) && ($(this).find("*").val(""), popup.success())
      })
    },
      t = function (e, t) {
        var o = 0;
        return t.find("*").removeClass("error"), t.find(".error__text").remove(), e.forEach(function (e) {
          if ("mail" == e.attr("name") && ("" == e.val() || !mail_right(e.val()))) {
            o++ , e.addClass("error");
            var t = "Неверный Email";
            "" == e.val() && (t = "Введите Email"), e[0].outerHTML += "<span class='error__text'>" + t + "</span>"
          }
        }), 0 == o
      };
    e()
  },
  sliders = function () {
    if ($(".lenta_body.tablet_slider").length > 0)
      for (var e = 0; e < $(".lenta_body.tablet_slider").length; e++) $(".lenta_body.tablet_slider").eq(e).slick({
        slidesToShow: 5,
        slidesToScroll: 1,
        speed: 600,
        infinite: !1,
        dots: !1,
        arrows: !1,
        responsive: [{
          breakpoint: 950,
          settings: {
            slidesToShow: 3
          }
        }, {
          breakpoint: 768,
          settings: {
            slidesToShow: 2
          }
        }, {
          breakpoint: 500,
          settings: {
            slidesToShow: 1
          }
        }]
      })
  },
  additional_functions = function (e) {
    animate_open_close = function (t, o, a) {
      var i = e;
      o || t.hasClass("active") ? (t.removeClass("open"), setTimeout(function () {
        t.removeClass("active")
      }, i)) : (t.addClass("active"), setTimeout(function () {
        t.addClass("open")
      }, 0)), a && setTimeout(function () {
        a()
      }, i)
    }, mail_right = function (e) {
      var t = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      return t.test(String(e).toLowerCase())
    }
  };